# API Overview [A look at the nautilus interface]

nautilus exposes many functions that are easy to use if you are just getting started, but highly configurable when needed.
On this page we will introduce the main capabilities of this interface and provide you with the links to specific feature documentations if you want to deep-dive further. 

Feel free to bookmark this page and use it as your entry-point when looking for specific documentation whenever you need it.

**Quick links on this page:**
- [Publishing](#publishing)
- [Editing](#editing)
- [Compute to Data](#compute-to-data)
- [Download](#download)

## Publishing

Constructing a so called [DDO (a DID document)](https://docs.oceanprotocol.com/developers/ddo-specification) can be challenging and time consuming.
nautilus aims to significantly streamline this process by exposing two main builder classes that provide typed APIs to help you with this process.

The `AssetBuilder` is the main class building the asset metadataand the `ServiceBuilder` class uses the same pattern allowing to configure the services used within the asset's metadata.


### AssetBuilder
Creating the builder is easy:

```ts twoslash
import { AssetBuilder } from '@deltadao/nautilus'

const assetBuilder = new AssetBuilder() // [!code focus]
```

With this we can now continue to setup the metadata information for the asset:

```ts twoslash
import { AssetBuilder } from '@deltadao/nautilus'

const assetBuilder = new AssetBuilder()

assetBuilder // [!code focus]
  .setType('dataset') // [!code focus]
  .setName('My New Asset') // [!code focus]
  .setDescription('This is a publish asset building test using Nautilus') // [!code focus]
  .setAuthor('Company Ltd.') // [!code focus]
```

The last step is to simply build the asset:

```ts twoslash
import { AssetBuilder } from '@deltadao/nautilus'

const assetBuilder = new AssetBuilder()

assetBuilder
  .setType('dataset')
  .setName('My New Asset')
  .setDescription('This is a publish asset building test using Nautilus')
  .setAuthor('Company Ltd.')

const asset = assetBuilder.build() // [!code focus]
```

To learn more about the `AssetBuilder` API head over to the detailed [AssetBuilder documentation](/docs/api/AssetBuilder).

### ServiceBuilder

Now, the asset above has some nice metadata setup, but we will not be able to really interact with it, unless we define the services it should expose.

This is where the `ServiceBuilder` class comes in handy to specify the necessary information, such as the method used to access our data or application we want to publish.

We start by setting up the `ServiceBuilder` we want to use:

```ts twoslash
import { UrlFile, FileTypes, ServiceTypes, ServiceBuilder } from '@deltadao/nautilus'

const serviceBuilder = new ServiceBuilder({ // [!code focus]
    serviceType: ServiceTypes.ACCESS, // [!code focus]
    fileType: FileTypes.URL // [!code focus]
}) // [!code focus]
```
> **_NOTE:_** There are multiple supported [ServiceTypes](/docs/api/ServiceTypes) and [FileTypes](/docs/api/FileTypes)

Next, we declare the "file" we want to publish. This can follow multiple protocols, here we'll use a HTTPS GET request:
```ts twoslash
import { UrlFile, FileTypes, ServiceTypes, ServiceBuilder } from '@deltadao/nautilus'

const serviceBuilder = new ServiceBuilder({
    serviceType: ServiceTypes.ACCESS,
    fileType: FileTypes.URL
})

const urlFile = {  // [!code focus]
  type: 'url',  // [!code focus]
  url: 'https://link.to/my/asset',  // [!code focus]
  method: 'GET'  // [!code focus]
}  // [!code focus]
```

Finally, we add the required metadata and the file we created utilizing the builder pattern to then build the service:
```ts twoslash
import { UrlFile, FileTypes, ServiceTypes, ServiceBuilder } from '@deltadao/nautilus'

const serviceBuilder = new ServiceBuilder({
    serviceType: ServiceTypes.ACCESS,
    fileType: FileTypes.URL
})

const urlFile = { 
  type: 'url', 
  url: 'https://link.to/my/asset', 
  method: 'GET' 
} satisfies UrlFile

const service = serviceBuilder // [!code focus]
    .setServiceEndpoint('https://provider.dev.pontus-x.eu') // [!code focus]
    .setTimeout(0) // [!code focus]
    .addFile(urlFile) // [!code focus]
    .setPricing({ // [!code focus]
        type: 'free' // [!code focus]
    }) // [!code focus]
    .build() // [!code focus]
```

> **_NOTE:_** The serviceEndpoint specified should point to the provider instance you want to be able to access your published data. [Learn more](https://docs.oceanprotocol.com/developers/provider).

To learn more about the `ServiceBuilder` API head over to the detailed [ServiceBuilder documentation](/docs/api/ServiceBuilder).

### Publishing the Asset

Bringing everything together, in the last step we will now anchor the asset on a network of your choice using the publish function provided by nautilus:

```ts twoslash
import { Nautilus, AssetBuilder, FileTypes, ServiceBuilder, ServiceTypes } from '@deltadao/nautilus'
import { Wallet } from 'ethers'

const signer = new Wallet('')
const nautilus = await Nautilus.create(signer)

const assetBuilder = new AssetBuilder()
const service = new ServiceBuilder({ serviceType: ServiceTypes.ACCESS, fileType: FileTypes.URL}).build()

// ---cut---
const asset = assetBuilder.addService(service).build() // [!code focus]
const result = await nautilus.publish(asset) // [!code focus]
```

If you want to learn more about the supported configuration during publish, you can head over to the [PublishConfig documentation](/docs/api/PublishConfig).
For a more complete overview of the publishing process, please navigate to the dedicated [Publish documentation](/docs/guides/publishing).

## Editing
{/* TODO */}

For a more detailed overview of all configurations provided for the edit API, head over to the [Edit documentation](/docs/guides/editing).

## Compute to Data

The `Nautilus` instance we created in the setup step provides access to a `compute()` function that we can use to start new compute jobs.
This includes all potentially necessary orders for required datatokens as well as the signed request towards Ocean Provider to start the compute job itself.

### Starting a new job

Starting a new compute job can be very quick to achieve. The most basic configuration needs only the identifiers of both the dataset and algorithm:

```ts twoslash
import { Nautilus } from '@deltadao/nautilus'
import { Wallet } from 'ethers'
const signer = new Wallet('')
const nautilus = await Nautilus.create(signer)
// ---cut---
const dataset = {
    did: 'did:op:123abc...'
}

const algorithm = {
    did: 'did:op:123abc...'
}

await nautilus.compute({ // [!code focus]
    dataset, // [!code focus]
    algorithm // [!code focus]
}) // [!code focus]
```
The compute job resulting from this start request can be used in future interactions, for example you can store the specific `jobId` to reference it later:

```ts twoslash
import { Nautilus } from '@deltadao/nautilus'
import { Wallet } from 'ethers'
const signer = new Wallet('')
const nautilus = await Nautilus.create(signer)

const dataset = {
  did: 'did:op:123abc...'
}

const algorithm = {
  did: 'did:op:123abc...'
}
// ---cut---
const computeJob = await nautilus.compute({
  dataset,
  algorithm
})

const job = Array.isArray(computeJob) ? computeJob[0] : computeJob

const { jobId } = job
```

### Get a compute job status

Now that you have a reference to any job you started, it is straight forward to monitor the status:

```ts twoslash
import { Nautilus } from '@deltadao/nautilus'
import { Wallet } from 'ethers'
const signer = new Wallet('')
const nautilus = await Nautilus.create(signer)
const jobId = ''
// ---cut---
const computeJobStatus = await nautilus.getComputeStatus({
  jobId, // using our extracte jobId
  providerUri: 'https://v4.provider.oceanprotocol.com/'
})
```
> **NOTE:** The providerUri should be the serviceEndpoint of the dataset that was computed on. This is where compute jobs are managed and retrieved.

### Get compute job results

Once a compute job has finished and you want to access the results, this is again very straight forward:

```ts twoslash
import { Nautilus } from '@deltadao/nautilus'
import { Wallet } from 'ethers'
const signer = new Wallet('')
const nautilus = await Nautilus.create(signer)
const jobId = ''
const providerUri = 'https://v4.provider.oceanprotocol.com/'

// ---cut---
const computeResultUrl = await nautilus.getComputeResult({
  jobId, // use your previously saved jobId
  providerUri // use the provider as described above
})
const result = await fetch(computeResultUrl)
```
For a deep-dive into everything possible with the compute APIs, head over to the [Compute-to-Data documentation](/docs/guides/compute-to-data).

## Download

To access assets or more specifically their respective services, we can again make use of a dedicated function provided by the nautilus interface.

In the most basic version, nothing else than the did of the asset to be accessed is needed:

```ts twoslash
import { Nautilus } from '@deltadao/nautilus'
import { Wallet } from 'ethers'
const signer = new Wallet('')
const nautilus = await Nautilus.create(signer)

// ---cut---
const accessUrl = await nautilus.access({
  assetDid: 'did:op:123abc'
})
const data = await fetch(accessUrl)
```

You can find an extended overview of the access API, by heading over to the [Download documentation](/docs/guides/download).